# Aria2 Download Forwarder - Chrome 扩展

这是一个功能~~强大~~且无缝集成的 Chrome 浏览器扩展，旨在将所有浏览器下载任务自动、静默地转发给您本地运行的 Aria2 实例。

## ✨ 核心功能

*   **全自动无缝拦截**: 自动拦截所有标准下载（包括左键点击、右键“另存为...”），无需任何额外操作。
*   **精准的文件名**: 自动获取服务器建议的正确文件名（从 `Content-Disposition` 头解析），告别 `download`、`xyz.php` 等无意义的文件名。
*   **干净的下载栏**: 拦截过程干净利落，不会在 Chrome 下载栏留下任何“已取消”的干扰项。
*   **智能 URL 处理**: 自动识别并豁免由浏览器内部生成的 `blob:` 或 `data:` URL，让 Photopea、Canva 等 Web 应用的导出功能正常工作。
*   **高度可配置**:
    *   通过弹出窗口，一键启用/禁用下载拦截和桌面通知。
    *   通过独立的设置页面，轻松配置 Aria2 RPC 地址和密钥。
*   **极简架构**: 移除了所有不必要的 UI（如自定义右键菜单），完全融入浏览器原生操作，隐身于后台。

## 🛠️ 安装指南

由于此扩展仍在开发，暂未上架 Chrome 网上应用店，您需要通过开发者模式手动加载。

1.  **克隆仓库**: git clone https://github.com/Siltal/aria2-download-forwarder

2.  **加载扩展**:
    *   打开 Chrome 浏览器，在地址栏输入 `chrome://extensions` 并回车。
    *   在页面右上角，打开 **“开发者模式”** 的开关。
    *   点击左上角的 **“加载已解压的扩展程序”** 按钮。
    *   在弹出的文件选择窗口中，选择您在第一步克隆的 `aria2-chrome-extension` 文件夹。

3.  **完成**: 如果一切顺利，您将在扩展列表中看到 "Aria2 Download Forwarder"，并在浏览器工具栏看到它的图标。

## ⚙️ 配置方法

在使用前，您需要正确配置 Aria2 和本扩展。

### 1. 配置 Aria2

请确保您的 Aria2 正在运行，并且**开启了 RPC 服务**。一个推荐的启动命令示例如下：

```bash
# --enable-rpc: 启用 RPC
# --rpc-listen-all: 允许来自任何 IP 的连接（对于局域网访问是必要的）
# --rpc-secret=<YOUR_SECRET_TOKEN>: 设置一个安全的 RPC 密钥（强烈推荐）
aria2c --enable-rpc --rpc-listen-all --rpc-secret=<YOUR_SECRET_TOKEN>
```

### 2. 配置扩展

*   在 Chrome 工具栏右键点击扩展图标，选择 **“选项”**。
*   在打开的设置页面中：
    *   **启用下载拦截**: 确保此开关是打开的。
    *   **显示桌面通知**: 根据您的偏好打开或关闭。
    *   **Aria2 RPC 地址**: 填入您的 Aria2 RPC 地址。如果 Aria2 和浏览器在同一台电脑上，通常是 `http://127.0.0.1:6800/jsonrpc`。如果您想从局域网内另一台电脑连接，请填入对应的 IP 地址，例如 `http://192.168.1.118:6800/jsonrpc`。
    *   **Aria2 RPC 密钥**: 填入您启动 Aria2 时设置的 `--rpc-secret` 值。如果没有设置，请留空。
*   点击 **“保存设置”**。

## 🚀 如何使用

配置完成后，扩展将自动在后台工作。

*   **普通下载**: 当您在网页上点击一个下载链接时，任务会自动发送给 Aria2。
*   **带验证的下载**: 当您在需要登录的网站（如 Pixiv、百度网盘等）下载文件时，扩展会自动附带上您的登录信息（Cookie），让 Aria2 能成功下载。
*   **图片/链接另存为**: 当您在图片或链接上右键，选择 **“图片另存为...”** 或 **“链接另存为...”** 时，会短暂弹出一个文件保存窗口（这是浏览器原生行为），但它会立刻消失，下载任务同样会被成功发送给 Aria2，并附带所有必要的请求头和正确的文件名。

您可以通过点击工具栏的扩展图标，在弹出窗口中随时暂停或恢复下载拦截。